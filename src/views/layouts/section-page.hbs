<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{company.name}} | {{#if currentSectionId}}{{getSectionDisplayName currentSectionId}}{{else}}Secci√≥n{{/if}}</title>
    <link rel="icon" href="{{company.favicon}}">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    {{!-- Incluir estilos seg√∫n el estilo elegido --}}
    {{#if (eq style "clasico")}}
        {{> styles/clasico}}
    {{else if (eq style "moderno")}}
        {{> styles/moderno}}
    {{else if (eq style "minimalista")}}
        {{> styles/minimalista}}
    {{else if (eq style "colorido")}}
        {{> styles/colorido}}
    {{/if}}

    <style>
        .section-navigation {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .section-nav-item {
            display: block;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .section-nav-item:hover {
            background: var(--primary-color, #8b5cf6);
            color: white;
            transform: translateX(-5px);
        }
        
        .section-nav-item.active {
            background: var(--primary-color, #8b5cf6);
            color: white;
        }
        
        .breadcrumb {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .breadcrumb a {
            color: var(--primary-color, #8b5cf6);
            text-decoration: none;
            font-weight: 500;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .breadcrumb .separator {
            margin: 0 10px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .section-navigation {
                position: fixed;
                bottom: 20px;
                right: 20px;
                top: auto;
                transform: none;
                border-radius: 25px;
                padding: 10px;
            }
            
            .section-nav-item {
                padding: 6px 10px;
                font-size: 12px;
                margin: 3px 0;
            }
        }
    </style>
</head>
<body class="font-body">
    <div class="min-h-screen flex flex-col">
        {{!-- Breadcrumb de navegaci√≥n --}}
        <div class="breadcrumb">
            <a href="/api/v1/client-templates/{{clientId}}/pages">üè† Inicio</a>
            <span class="separator">/</span>
            <span>{{#if currentSectionId}}{{getSectionDisplayName currentSectionId}}{{else}}Secci√≥n{{/if}}</span>
        </div>
        
        {{!-- Navegaci√≥n lateral de secciones --}}
        <div class="section-navigation">
            <div style="font-weight: bold; margin-bottom: 10px; text-align: center; font-size: 12px; color: #666;">
                Secciones
            </div>
            {{#each allSections}}
                {{#if enabled}}
                <a href="/api/v1/client-templates/{{../clientId}}/section/{{id}}" 
                   class="section-nav-item {{#if (eq id ../currentSectionId)}}active{{/if}}">
                    {{getSectionDisplayName id}}
                </a>
                {{/if}}
            {{/each}}
        </div>
        
        <main class="flex-1">
            {{!-- Renderizar SOLO la secci√≥n actual --}}
            {{#each sections}}
                {{#if (eq id "hero")}}
                    {{> sections/hero data=data}}
                {{else if (eq id "about")}}
                    {{> sections/about data=data}}
                {{else if (eq id "products")}}
                    {{> sections/products data=data}}
                {{else if (eq id "services")}}
                    {{> sections/services data=data}}
                {{else if (eq id "testimonials")}}
                    {{> sections/testimonials data=data}}
                {{else if (eq id "gallery")}}
                    {{> sections/gallery data=data}}
                {{else if (eq id "contact")}}
                    {{> sections/contact data=data}}
                {{else if (eq id "cart")}}
                    {{> sections/cart data=data}}
                {{else if (eq id "appointments")}}
                    {{> sections/appointments data=data}}
                {{else if (eq id "stats")}}
                    {{> sections/stats data=data}}
                {{/if}}
            {{/each}}
        </main>
        
        {{!-- Footer simplificado para p√°ginas individuales --}}
        <footer class="bg-gray-900 text-white py-8">
            <div class="container mx-auto px-4 text-center">
                <p>&copy; {{currentYear}} {{company.name}}. Todos los derechos reservados.</p>
                <div class="mt-4">
                    <a href="/api/v1/client-templates/{{clientId}}/pages" class="text-blue-400 hover:text-blue-300">
                        ‚Üê Volver al √≠ndice
                    </a>
                </div>
            </div>
        </footer>
    </div>
    
    {{!-- Scripts seg√∫n el estilo --}}
    {{#if (eq style "clasico")}}
        {{> scripts/clasico}}
    {{else if (eq style "moderno")}}
        {{> scripts/moderno}}
    {{else if (eq style "minimalista")}}
        {{> scripts/minimalista}}
    {{else if (eq style "colorido")}}
        {{> scripts/colorido}}
    {{/if}}
    
    {{!-- Script para funcionalidad de navegaci√≥n --}}
    <script>
    // Datos globales
    window.allSections = {{{json allSections}}};
    window.clientId = "{{clientId}}";
    window.company = {{{json company}}};
    window.currentSectionId = "{{currentSectionId}}";
    
    // Funci√≥n para obtener el nombre de visualizaci√≥n de una secci√≥n
    window.getSectionDisplayName = function(sectionId) {
        const displayNames = {
            hero: "Inicio",
            about: "Nosotros",
            products: "Productos",
            services: "Servicios",
            testimonials: "Testimonios",
            gallery: "Galer√≠a",
            contact: "Contacto",
            cart: "Carrito",
            appointments: "Citas",
            stats: "Estad√≠sticas"
        };
        return displayNames[sectionId] || sectionId;
    };
    
    // Navegaci√≥n con teclado
    document.addEventListener('keydown', function(e) {
        const enabledSections = window.allSections.filter(s => s.enabled);
        const currentIndex = enabledSections.findIndex(s => s.id === window.currentSectionId);
        
        if (e.key === 'ArrowLeft' && currentIndex > 0) {
            // Navegar a la secci√≥n anterior
            const prevSection = enabledSections[currentIndex - 1];
            window.location.href = `/api/v1/client-templates/${window.clientId}/section/${prevSection.id}`;
        } else if (e.key === 'ArrowRight' && currentIndex < enabledSections.length - 1) {
            // Navegar a la siguiente secci√≥n
            const nextSection = enabledSections[currentIndex + 1];
            window.location.href = `/api/v1/client-templates/${window.clientId}/section/${nextSection.id}`;
        } else if (e.key === 'Home') {
            // Ir al √≠ndice
            window.location.href = `/api/v1/client-templates/${window.clientId}/pages`;
        }
    });
    
    // Mostrar indicador de navegaci√≥n por teclado
    console.log('üéÆ Navegaci√≥n por teclado disponible:');
    console.log('   ‚Üê Flecha izquierda: Secci√≥n anterior');
    console.log('   ‚Üí Flecha derecha: Siguiente secci√≥n');
    console.log('   Home: Volver al √≠ndice');
    </script>
</body>
</html>
